<div fxLayout="column" class="risk-investigation-top-level" fxFlex *ngIf="cockpitReady">
  <div>
    <tc-tibco-cloud-menu-bar [burgerMenuButtons]="burgerMenuButtons" [toolbarButtons]="toolbarButtons"
                             [headerText]="title"
                             (toolbarButtonEvent)="handleToolbarButtonEvent($event)"
                             (burgerMenuButtonEvent)="handleBurgerMenuClick($event)">
      <div fxFlex fxLayout="row" fxLayoutAlign="space-between center">
        <ng-content select="[customToolbarContent]" fxFlex></ng-content>
        <mat-button-toggle-group style="margin-left: 50px" class="nav-switch-bar" name="view" aria-label="Font Style"
                                 [value]="'home'" (change)="handleBurgerMenuClick($event.value)">
          <mat-button-toggle [name]="'home'" [value]="'home'"
                             fxLayoutAlign="center center">Analytics View
          </mat-button-toggle>
          <mat-button-toggle [name]="'overview'" [value]="'overview'"
                             fxLayoutAlign="center center">Cases View
          </mat-button-toggle>
        </mat-button-toggle-group>

        <tcla-live-apps-application-create-button *ngIf="caseStartButtonActive"
                                                  style="margin-left: 20px" [sandboxId]="sandboxId"
                                                  [appIds]="appIds"
                                                  (selection)="handleCreatorAppSelection($event)"></tcla-live-apps-application-create-button>
      </div>
    </tc-tibco-cloud-menu-bar>
  </div>

  <div class="tcs-home-content"
       style="padding-left: 20px; padding-right: 20px; margin-top: 10px; padding-bottom: 120px; height: calc(100% - 86px); display: block;">
    <div style="height: 100%;">
       <div style="margin-bottom: 20px; overflow: hidden; height: 100%; min-height: 750px; padding-bottom: 10px;"
           fxLayoutGap="20px"
           fxLayout="row" fxLayout.lt-md="column">
        <div fxFlex.gt-sm="grow" fxLayout="column" style="" [ngStyle.lt-md]="'min-height: 400px;'">
          <div class="recentCasesWidget" fxFill>
            <div class="tcs-pane" fxFill fxLayout="column">
              <div class="tcs-header" fxLayout="row" fxLayoutAlign="space-between center">
                <div fxLayoutAlign="start center">
                  <mat-icon class="tcs-icon tcs-active-case-widget-icon"
                            svgIcon="ic-active-case-widget-icon"></mat-icon>
                  <div class="tcs-header-text">TIBCO Cloud Spotfire - Risk Investigations</div>
                </div>
              </div>
              <mat-tab-group fxFlex [selectedIndex]="selected.value" (selectedTabChange)="tabChange($event)">
                <mat-tab label="View Score Distribution">
                </mat-tab>
                <mat-tab label="Set Thresholds">
                </mat-tab>
                <mat-tab label="Transaction Map">
                </mat-tab>
                <mat-tab label="Create Cases">
                </mat-tab>
                <mat-tab label="Track Cases">
                </mat-tab>
              </mat-tab-group>
              <tcsf-spotfire-wrapper style="width: 100%; height: 100%;" [url]="sFConfig.spotfireServer"
                                     [path]="sFConfig.analysisPath"
                                     [customization]='{"showAbout": false,
                                                        "showAnalysisInformationTool": false,
                                                        "showAuthor": false,
                                                        "showClose": false,
                                                        "showCustomizableHeader": false,
                                                        "showDodPanel": false,
                                                        "showExportFile": false,
                                                        "showExportVisualization": false,
                                                        "showFilterPanel": false,
                                                        "showHelp": true,
                                                        "showLogout": false,
                                                        "showPageNavigation": false,
                                                        "showAnalysisInfo": false,
                                                        "showReloadAnalysis": false,
                                                        "showStatusBar": false,
                                                        "showToolBar": false,
                                                        "showUndoRedo": false}'
                                     [page]="activepage"
                                     [markingOn]="'*'"
                                     (markingEvent)="marking($event);"
                                     [maxRows]='1000'
                                     id="id1">
              </tcsf-spotfire-wrapper>
            </div>
          </div>
        </div>
        <div fxFlex.gt-sm="40" fxLayout="column" [ngStyle.lt-md]="'min-height: 400px'">
          <div style="height: 350px;">
            <div class="recentCasesWidget" fxFill>
              <div class="tcs-pane" fxFill fxLayout="column">
                <div class="tcs-header" fxLayout="row" fxLayoutAlign="space-between center">
                  <div fxLayoutAlign="start center">
                    <mat-icon class="tcs-icon tcs-active-case-widget-icon"
                              svgIcon="ic-active-case-widget-icon"></mat-icon>
                    <div class="tcs-header-text">Investigations</div>
                  </div>
                </div>
                <mat-tab-group fxFlex>
                  <mat-tab label="Recent Cases">
                    <ng-template matTabContent>
                      <div class="recentCasesWidget" fxFill>
                        <tcla-live-apps-recent-cases class="padded-widget" [showHeader]="true" [sandboxId]="sandboxId"
                                                     [uiAppId]="uiAppId"
                                                     (clickCase)="clickCaseAction($event)"></tcla-live-apps-recent-cases>
                      </div>
                    </ng-template>
                  </mat-tab>
                  <mat-tab label="Favorite Cases">
                    <ng-template matTabContent>
                      <div class="favoriteCasesWidget" fxFill>
                        <tcla-live-apps-favorite-cases class="padded-widget" [showHeader]="true" [sandboxId]="sandboxId"
                                                       [uiAppId]="uiAppId"
                                                       (clickCase)="clickCaseAction($event)"></tcla-live-apps-favorite-cases>
                      </div>
                    </ng-template>
                  </mat-tab>
                </mat-tab-group>
              </div>
            </div>
          </div>
          <div fxFlex="noshrink" style="height: 350px; margin-top: 20px;">
                <tcla-live-apps-notes [userId]="userId" [header]="'Feed'" [showHeader]="true" [relatedItemId]="uiAppId"
                                      [relatedItemType]="'CASE_APP'"></tcla-live-apps-notes>
         </div>
      </div>
    </div>
  </div>
</div>
