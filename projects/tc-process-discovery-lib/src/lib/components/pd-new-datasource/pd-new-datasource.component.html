<div fxLayout="column" class="tcs-new-datasource-settings-pane" fxFill>
    <tc-tibco-cloud-widget-header style="height: 40px;" [icon]="'tcs-capabilities'"
        [headerText]="'New Datasource Configuration'"></tc-tibco-cloud-widget-header>
    <div style="padding: 20px;" fxLayout="column" fxFlex>
        <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="5px" style="height: 20px">
            <p>Choose the configuration to be used within this datasource:</p>
        </div>
        <div fxLayout="column">
            <div fxLayout="row" >
                <mat-form-field>
                    <input matInput placeholder="Filename" [(ngModel)]="filename">
                </mat-form-field>
                
                <div>
                    <input fxFlex="40" class="tcs-hidden-input" type="file" accept=".csv" #file (change)="onFileSelect(file.files)">
                </div>
            </div>
            <div cdkScrollable *ngIf="filename.length > 0" fxLayout="column">
                <!-- Preview table -->
                <div>
                <table *ngIf="data" fxFlex mat-table [dataSource]="data" class="mat-elevation-z8">
                    <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumns">
                        <th mat-header-cell *matHeaderCellDef>
                            {{column}}
                            <!-- <mat-icon [svgIcon]="'tcs-case-start-icon'"></mat-icon> -->
                        </th>
                        <td mat-cell *matCellDef="let element"> {{element[column]}} </td>
                    </ng-container>
                
                    <tr  fxFlexAlign="center" mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                </div>
                <mat-accordion>
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>Options</mat-panel-title>
                            <mat-panel-description>Options for parsing the file</mat-panel-description>
                        </mat-expansion-panel-header>
                        <div fxLayout="row" fxLayoutAlign="space-between stretch">
                            <div fxLayout="column">
                                <mat-checkbox [(ngModel)]="preview">Preview</mat-checkbox>
                                <mat-form-field>
                                    <input [disabled]="!preview" matInput="number" placeholder="Number of rows to preview" [(ngModel)]="numberRowsForPreview">
                                </mat-form-field>
                            </div>
                            <div fxLayout="column">
                                <mat-checkbox [(ngModel)]="useFirstRowAsHeader">Use first row as header</mat-checkbox>
                                <mat-form-field>
                                    <input matInput placeholder="Column separator" maxlength="1" [(ngModel)]="columnSeparator">
                                </mat-form-field>
                            </div>
                            <div fxLayout="column">
                                <mat-checkbox [(ngModel)]="skipComments">Skip comments in file</mat-checkbox>
                                <mat-form-field>
                                    <input [disabled]="!skipComments" matInput placeholder="Coments" maxlength="10" [(ngModel)]="comments">
                                </mat-form-field>
                            </div>
                            <div fxLayout="column">
                                <mat-checkbox [(ngModel)]="skipEmptyLines">Skip empty lines</mat-checkbox>
                                <mat-form-field>
                                    <input matInput placeholder="Encoding" [(ngModel)]="encoding">
                                </mat-form-field>
                            </div>
                        </div>
                        <mat-action-row>
                            <button mat-raised-button color="primary" (click)="refresh()">Refresh</button>
                        </mat-action-row>                
                    </mat-expansion-panel>
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>Mapping</mat-panel-title>
                            <mat-panel-description>Options for mapping</mat-panel-description>
                        </mat-expansion-panel-header>
                        <div fxLayout="row" fxLayoutAlign="space-between stretch">
                            <div fxFlex="33" fxLayout="column">
                                <mat-form-field>
                                    <mat-label>CaseId</mat-label>
                                    <mat-select [(value)]="caseId">
                                        <mat-option *ngFor="let column of displayedColumns" [value]="column">{{column}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field>
                                    <mat-label>Start</mat-label>
                                    <mat-select [(value)]="start">
                                        <mat-option *ngFor="let column of displayedColumns" [value]="column">{{column}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div fxFlex="33" fxLayout="column">
                                <mat-form-field>
                                    <mat-label>Activity</mat-label>
                                    <mat-select [(value)]="activity">
                                        <mat-option *ngFor="let column of displayedColumns" [value]="column">{{column}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field>
                                    <mat-label>End</mat-label>
                                    <mat-select [(value)]="end">
                                        <mat-option *ngFor="let column of displayedColumns" [value]="column">{{column}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div fxFlex="33" fxLayout="column">
                                <mat-form-field>
                                    <mat-label>Resources</mat-label>
                                    <mat-select [(value)]="resource" multiple>
                                        <mat-option *ngFor="let column of displayedColumns" [value]="column">{{column}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field>
                                    <mat-label>Others</mat-label>
                                    <mat-select [(value)]="other" multiple>
                                        <mat-option *ngFor="let column of displayedColumns" [value]="column">{{column}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>

                    </mat-expansion-panel>
                </mat-accordion>

                <!-- Icons for drag and drop -->
                <!-- <div fxLayout="row" >
                    <div fxFlex fxLayout="column" fxLayoutAlign="center center" *ngFor="let element of icons" cdkDrag>
                        <mat-icon>{{element.icon}}</mat-icon>
                        <div>{{element.id}}</div>
                    </div>
                </div>
                 -->
            </div>
            <!--- -->
<!-- <div>
                <div cdkDropList #todoList="cdkDropList" [cdkDropListData]="todo" [cdkDropListConnectedTo]="[doneList]"
                    class="example-list" (cdkDropListDropped)="drop($event)">
                    <div class="example-box" *ngFor="let item of todo" cdkDrag>{{item}}</div>
                </div>

                <div class="example-container">
                    <h2>Done</h2>

                    <div cdkDropList #doneList="cdkDropList" [cdkDropListData]="done" [cdkDropListConnectedTo]="[todoList]"
                        class="example-list" (cdkDropListDropped)="drop($event)">
                        <div class="example-box" *ngFor="let item of done" cdkDrag>{{item}}</div>
                    </div>
                </div>
</div> -->
                <!---- -->
        </div> 
        <div style="border-width: 1px;border-color:red;border-style: dashed" cdkDropList #doneList="cdkDropList" fxFlex class="tcs-filler-panel"></div>
        <div fxLayout="row" fxLayoutAlign="end end" fxLayoutGap="5px" style="min-height: 50px">
            <button [disabled]="filename.length == 0" mat-raised-button color="primary">Create datasource</button>
            <button *ngIf="filename.length == 0" mat-raised-button color="primary" (click)="file.click()">Select file</button>
            <button *ngIf="filename.length > 0" mat-raised-button color="primary" (click)="file.click()">Change file</button>
        </div>
    </div>
</div>