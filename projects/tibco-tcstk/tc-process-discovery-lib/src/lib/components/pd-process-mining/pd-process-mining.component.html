<div fxLayout="column" class="process-mining-top-level" fxFlex>
    <div *ngIf="currentDatasource != undefined">
        <tc-tibco-cloud-menu-bar [toolbarButtons]="toolbarButtons" [headerText]="title" (toolbarButtonEvent)="handleToolbarButtonEvent($event)">
            <div fxFlex fxLayout="row" fxLayoutAlign="space-between center">
                <div fxFlex="33" fxLayoutAlign="center none">
                    <tcla-live-apps-role-switcher *ngIf="displayRoles.length > 1" [roles]="displayRoles" [selectedRole]="currentRole" (changeRoleEvent)="roleChange($event)"></tcla-live-apps-role-switcher>
                </div>
                <div fxFlex="33">
                    <mat-button-toggle-group class="nav-switch-bar" name="view" aria-label="Font Style" [value]="'process-mining-view'" (change)="handleViewButtonEvent($event)" >
                        <mat-button-toggle *ngFor="let view of viewButtons" name="{{view.tooltip}}" value="{{view.id}}"
                        fxLayoutAlign="center center">{{view.tooltip}}</mat-button-toggle>
                    </mat-button-toggle-group>
                </div>
                <tcla-live-apps-application-create-button [sandboxId]="sandboxId" [appIds]="appIds" (selection)="handleCreatorAppSelection($event)" fxFlex="33" fxLayoutAlign="end none" >
                </tcla-live-apps-application-create-button>
            </div>
        </tc-tibco-cloud-menu-bar>
    </div>
    
    <div *ngIf="currentDatasource != undefined" fxFlex fxLayout="column" style="padding-bottom: 20px">
        <div>
            <mat-tab-group (selectedTabChange)="tabChange($event)">
                <mat-tab *ngFor="let page of allowedPages" label="{{page}}"></mat-tab>
            </mat-tab-group>
        </div>
        <div fxFlex fxLayout="column">
            <tcsf-spotfire-wrapper fxFlex  [url]="spotfireServer" 
                                        [path]="analysisPath" 
                                        [page]="activePage" 
                                        [customization]="configuration"
                                        [parameters]="parameters"
                                        [markingOn]="markingOn"
                                        (markingEvent)="marking($event)">
            </tcsf-spotfire-wrapper>
        </div>
    </div>
</div>