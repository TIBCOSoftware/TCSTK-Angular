<div fxFill fxLayout="column" fxLayoutAlign="space-between stretch" style="overflow: hidden">
  <tc-tibco-cloud-menu-bar [toolbarButtons]="toolbarButtons" (toolbarButtonEvent)="handleToolbarButtonEvent($event)">
    <!-- this is content projection. Tibco cloud menu bar contains ng-template and content here is projected inside the ng-content -->
    <tcla-live-apps-case-summary class="live-apps-widget" [uiAppId]="uiAppId" [typeBar]="true" [borderCard]="false" [displayType]="'staticlist'" [sandboxId]="sandboxId" [caseRef]="caseRef"></tcla-live-apps-case-summary>
  </tc-tibco-cloud-menu-bar>
  <div *ngIf="valid" fxLayout="column" fxFlex fxFill style="padding: 20px; overflow: hidden;">
    <div fxLayout="row" fxLayoutAlign="start start">
      <tcla-live-apps-case-states fxFlex [sandboxId]="sandboxId" [caseRef]="caseRef" [appId]="appId"></tcla-live-apps-case-states>
    </div>

    <!--<div fxLayout="row" fxLayoutAlign="end center" class="tcs-actions-bar">
      <tcla-live-apps-case-actions [sandboxId]="sandboxId" [typeId]="typeId" [appId]="appId" [caseRef]="caseRef" [caseState]="'Created'" [maxActions]="5" (actionClicked)="handleActionSelection($event)"></tcla-live-apps-case-actions>
    </div>-->
    <div fxLayout="row" fxFlex style="overflow: hidden;">
      <div fxFlex fxLayoutGap="20px">
        <div fxLayout="column" fxFill fxFlex="70" style="min-width: 70%">
          <mat-tab-group #dataTabGroup style="overflow: hidden">
            <mat-tab label="Case Data">
              <tcla-live-apps-case-data class="live-apps-widget" fxFill [caseRef]="caseRef" [sandboxId]="sandboxId" [uiAppId]="uiAppId" [appId]="appId" [typeId]="typeId" [layout]="layout" [showHeader]="false"></tcla-live-apps-case-data>
            </mat-tab>
            <mat-tab #actionTab *ngIf="actionSelection">
              <ng-template mat-tab-label fxLayout="row" fxFlex>
                {{actionSelection?.process?.name ? actionSelection.process.name : 'Action' }}
                <mat-icon fxLayoutAlign="end start" class="tcs-cancel-action-button" [svgIcon]="'tcs-close-icon'" (click)="handleCancelAction()"></mat-icon>
              </ng-template>
              <tcla-live-apps-case-action *ngIf="actionSelection" tcOnCreate (fireCreated)="actionTabCreated($event)" [process]="actionSelection" [caseRef]="caseRef" [typeId]="typeId" [applicationId]="appId" [sandboxId]="sandboxId" (caseChanged)="handleActionCompleted($event)"></tcla-live-apps-case-action>
            </mat-tab>
          </mat-tab-group>
        </div>
        <div fxLayout="column" fxFlex fxLayoutGap="20px">
          <mat-tab-group fxFlex style="overflow: hidden">
            <mat-tab label="Documents">
              <ng-template matTabContent>

                <tccwm-cwm-case-data-for-internal-doc [caseRef]="caseRef" [sandboxId]="sandboxId" [uiAppId]="uiAppId" [appId]="appId" [typeId]="typeId" [layout]="layout" [showHeader]="false"></tccwm-cwm-case-data-for-internal-doc>

                <tcla-live-apps-documents class="live-apps-widget" [sandboxId]="sandboxId" [folderId]="caseRef" [folderType]="'caseFolders'"></tcla-live-apps-documents>
              </ng-template>
            </mat-tab>
            <mat-tab label="Notes">
              <ng-template matTabContent>
                <tcla-live-apps-notes class="live-apps-widget" [relatedItemType]="'CASE_APP'" [relatedItemId]="caseRef" [userId]="userId"></tcla-live-apps-notes>
              </ng-template>
            </mat-tab>

            <mat-tab label="States">
              <ng-template matTabContent>
                <tcla-live-apps-case-state-audit [caseRef]="caseRef" [sandboxId]="sandboxId" [appId]="appId"></tcla-live-apps-case-state-audit>
              </ng-template>
            </mat-tab>
           <!-- <mat-tab label="Audit">
              <ng-template matTabContent>
                <tcla-live-apps-case-audit [sandboxId]="sandboxId" [caseRef]="caseRef"></tcla-live-apps-case-audit>
              </ng-template>
            </mat-tab>-->
          </mat-tab-group>
        </div>
      </div>
    </div>
  </div>
</div>
